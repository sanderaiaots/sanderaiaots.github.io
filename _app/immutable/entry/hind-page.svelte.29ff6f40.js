import{S as Ae,i as Le,s as Pe,k as c,r as o,a as y,l as h,m as g,u as s,h as p,c as G,p as le,b as Se,G as e,N as Be,v as P,n as we,O as Ce,H as Fe,o as Ie}from"../chunks/index.d5371c42.js";import{w as Ne}from"../chunks/index.e47fd4b9.js";const Re=Ne([]);function Ue(a,t,d){const b=a.slice();return b[8]=t[d],b}function Oe(a){let t,d,b=new Date(a[8].timestamp*1e3).toLocaleString()+"",B,H,D,v=a[8].price+"",O,l,C=(a[8].price*1.2).toFixed(2)+"",i,w,T,S=a[0][a[8].timestamp]+"",R,A,U,k=a[8].price*a[0][a[8].timestamp]/1e3+"",F,L;return{c(){t=c("tr"),d=c("td"),B=o(b),H=y(),D=c("td"),O=o(v),l=c("td"),i=o(C),w=y(),T=c("td"),R=o(S),A=y(),U=c("td"),F=o(k),L=y()},l(f){t=h(f,"TR",{});var r=g(t);d=h(r,"TD",{});var I=g(d);B=s(I,b),I.forEach(p),H=G(r),D=h(r,"TD",{});var N=g(D);O=s(N,v),N.forEach(p),l=h(r,"TD",{});var j=g(l);i=s(j,C),j.forEach(p),w=G(r),T=h(r,"TD",{});var V=g(T);R=s(V,S),V.forEach(p),A=G(r),U=h(r,"TD",{});var M=g(U);F=s(M,k),M.forEach(p),L=G(r),r.forEach(p)},m(f,r){Se(f,t,r),e(t,d),e(d,B),e(t,H),e(t,D),e(D,O),e(t,l),e(l,i),e(t,w),e(t,T),e(T,R),e(t,A),e(t,U),e(U,F),e(t,L)},p(f,r){r&16&&b!==(b=new Date(f[8].timestamp*1e3).toLocaleString()+"")&&P(B,b),r&16&&v!==(v=f[8].price+"")&&P(O,v),r&16&&C!==(C=(f[8].price*1.2).toFixed(2)+"")&&P(i,C),r&17&&S!==(S=f[0][f[8].timestamp]+"")&&P(R,S),r&17&&k!==(k=f[8].price*f[0][f[8].timestamp]/1e3+"")&&P(F,k)},d(f){f&&p(t)}}}function je(a){let t,d,b,B,H,D,v,O,l,C,i,w,T,S,R=a[1]/24+"",A,U,k,F,L,f,r=a[2]/a[3]+"",I,N,j,V,M=a[2]*1.2+"",ae,ne,Q=a[2]*1.2/a[3]+"",oe,re,ie,Z,W,q,X,de,$,ce,x,he,ee,fe,te,pe,ue,Y,me,ge,z=a[4],E=[];for(let n=0;n<z.length;n+=1)E[n]=Oe(Ue(a,z,n));return{c(){t=c("section"),d=c("div"),b=o("Tere"),B=y(),H=c("p"),D=o("Lae oma tarbimise fail: "),v=c("input"),O=y(),l=c("p"),C=o("Total consumed: "),i=o(a[3]),w=o(" kwH, hours "),T=o(a[1]),S=o(", days "),A=o(R),U=y(),k=c("br"),F=o(`
		Total price (no vat): `),L=o(a[2]),f=o(" EUR, kwh avg "),I=o(r),N=o(" EUR "),j=c("br"),V=o(`
		Total price (vat): `),ae=o(M),ne=o(" EUR, kwh avg "),oe=o(Q),re=o(" EUR"),ie=y(),Z=c("table"),W=c("thead"),q=c("tr"),X=c("th"),de=o("Tund"),$=c("th"),ce=o("Hind"),x=c("th"),he=o("Hind + km"),ee=c("th"),fe=o("consumed"),te=c("th"),pe=o("Hind kokku"),ue=y(),Y=c("tbody");for(let n=0;n<E.length;n+=1)E[n].c();this.h()},l(n){t=h(n,"SECTION",{});var u=g(t);d=h(u,"DIV",{});var _=g(d);b=s(_,"Tere"),_.forEach(p),B=G(u),H=h(u,"P",{});var J=g(H);D=s(J,"Lae oma tarbimise fail: "),v=h(J,"INPUT",{type:!0,id:!0}),J.forEach(p),O=G(u),l=h(u,"P",{});var m=g(l);C=s(m,"Total consumed: "),i=s(m,a[3]),w=s(m," kwH, hours "),T=s(m,a[1]),S=s(m,", days "),A=s(m,R),U=G(m),k=h(m,"BR",{}),F=s(m,`
		Total price (no vat): `),L=s(m,a[2]),f=s(m," EUR, kwh avg "),I=s(m,r),N=s(m," EUR "),j=h(m,"BR",{}),V=s(m,`
		Total price (vat): `),ae=s(m,M),ne=s(m," EUR, kwh avg "),oe=s(m,Q),re=s(m," EUR"),m.forEach(p),ie=G(u),Z=h(u,"TABLE",{border:!0,cellpadding:!0,cellspacing:!0});var se=g(Z);W=h(se,"THEAD",{});var ve=g(W);q=h(ve,"TR",{});var K=g(q);X=h(K,"TH",{});var Te=g(X);de=s(Te,"Tund"),Te.forEach(p),$=h(K,"TH",{});var Ee=g($);ce=s(Ee,"Hind"),Ee.forEach(p),x=h(K,"TH",{});var be=g(x);he=s(be,"Hind + km"),be.forEach(p),ee=h(K,"TH",{});var ke=g(ee);fe=s(ke,"consumed"),ke.forEach(p),te=h(K,"TH",{});var He=g(te);pe=s(He,"Hind kokku"),He.forEach(p),K.forEach(p),ve.forEach(p),ue=G(se),Y=h(se,"TBODY",{});var De=g(Y);for(let _e=0;_e<E.length;_e+=1)E[_e].l(De);De.forEach(p),se.forEach(p),u.forEach(p),this.h()},h(){le(v,"type","file"),le(v,"id","consumtion-file"),le(Z,"border","1"),le(Z,"cellpadding","0"),le(Z,"cellspacing","0")},m(n,u){Se(n,t,u),e(t,d),e(d,b),e(t,B),e(t,H),e(H,D),e(H,v),e(t,O),e(t,l),e(l,C),e(l,i),e(l,w),e(l,T),e(l,S),e(l,A),e(l,U),e(l,k),e(l,F),e(l,L),e(l,f),e(l,I),e(l,N),e(l,j),e(l,V),e(l,ae),e(l,ne),e(l,oe),e(l,re),e(t,ie),e(t,Z),e(Z,W),e(W,q),e(q,X),e(X,de),e(q,$),e($,ce),e(q,x),e(x,he),e(q,ee),e(ee,fe),e(q,te),e(te,pe),e(Z,ue),e(Z,Y);for(let _=0;_<E.length;_+=1)E[_].m(Y,null);me||(ge=Be(v,"change",a[5]),me=!0)},p(n,[u]){if(u&8&&P(i,n[3]),u&2&&P(T,n[1]),u&2&&R!==(R=n[1]/24+"")&&P(A,R),u&4&&P(L,n[2]),u&12&&r!==(r=n[2]/n[3]+"")&&P(I,r),u&4&&M!==(M=n[2]*1.2+"")&&P(ae,M),u&12&&Q!==(Q=n[2]*1.2/n[3]+"")&&P(oe,Q),u&17){z=n[4];let _;for(_=0;_<z.length;_+=1){const J=Ue(n,z,_);E[_]?E[_].p(J,u):(E[_]=Oe(J),E[_].c(),E[_].m(Y,null))}for(;_<E.length;_+=1)E[_].d(1);E.length=z.length}},i:we,o:we,d(n){n&&p(t),Ce(E,n),me=!1,ge()}}}const Ze="https://dashboard.elering.ee/api/nps/price?start=2023-01-31T22:00:00.000Z&end=2023-02-21T21:59:59.999Z";function qe(a,t,d){let b;Fe(a,Re,i=>d(4,b=i));let B={167598e4:1},H={},D=0,v=0,O=0;Ie(async()=>{fetch(Ze).then(i=>i.json()).then(i=>{Re.set(i.data.ee),i.data.ee.forEach(w=>{H[w.timestamp]=w.price})}).catch(i=>console.log("data error",i))});function l(i){if(console.log("read data",i),i.target.files.length>0){const w=i.target.files[0];console.log("we got the file",w);const T=new FileReader;T.onload=C,T.readAsText(w)}}function C(i){const T=i.target.result.split(`
`);let S=!1,R={};d(2,v=0),d(1,D=0),d(3,O=0);for(let A=0;A<T.length;A++){const U=T[A];if(S){const k=U.split(";");if(k&&k.length&&k.length>3){const F=k[0].split(" "),L=F[0].split("."),f=F[1].split(":"),I=new Date(L[2],L[1]-1,L[0],f[0],f[1]).valueOf()/1e3;I==1675638e3&&console.log("see peab olemas olemas.....",U);const N=I.toString(),j=parseFloat(k[4].replace(",","."));R[N]=j,H[N]&&(d(2,v+=H[N]/1e3*j),d(3,O+=j),d(1,D++,D))}}U.indexOf("Algus")>=0&&(S=!0)}d(0,B=R),console.log("loaded "+Object.keys(R).length+" rows")}return[B,D,v,O,b,l]}class Me extends Ae{constructor(t){super(),Le(this,t,qe,je,Pe,{})}}export{Me as default};
